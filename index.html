<!DOCTYPE html>
<html>
  <head>
    <title>Sandbox</title>
    <meta charset="UTF-8" />
  </head>

  <body>
    <video autoplay id="video"></video>
    <button onClick="streamVideo()">Stream</button>
    <button onclick="capture()">Capture</button>
    <br />
    <canvas id="canvas" style="overflow: auto;"></canvas>
    <script>
      const streamVideo = () => {
        const video = document.querySelector("video");
        const options = { video: true };
        navigator.mediaDevices
          .getUserMedia(options)
          .then((stream) => (video.srcObject = stream))
          .catch((err) => console.log(err));

        setTimeout(() => {
          console.log("TES");

          var canvas = document.getElementById("canvas");
          var video = document.querySelector("video");
          canvas.width = video.videoWidth;
          canvas.height = video.videoHeight;
          canvas
            .getContext("2d")
            .drawImage(video, 0, 0, video.videoWidth, video.videoHeight);

          const playImage = new Image();
          playImage.src = "path to image asset";
          playImage.onload = () => {
            const startX = video.videoWidth / 2 - playImage.width / 2;
            const startY = video.videoHeight / 2 - playImage.height / 2;
            canvas
              .getContext("2d")
              .drawImage(
                playImage,
                startX,
                startY,
                playImage.width,
                playImage.height
              );
            canvas.toBlob() = (blob) => {
              const img = new Image();
              img.src = window.URL.createObjectUrl(blob);
            };
          };
        }, 2000);
      };
      /*
              setTimeout(() => {
                var canvas = document.getElementById("canvas");
                var video = document.querySelector("video");
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                canvas
                  .getContext("2d")
                  .drawImage(video, 0, 0, video.videoWidth, video.videoHeight);

                const playImage = new Image();
                playImage.src = "path to image asset";
                playImage.onload = () => {
                  const startX = video.videoWidth / 2 - playImage.width / 2;
                  const startY = video.videoHeight / 2 - playImage.height / 2;
                  canvas
                    .getContext("2d")
                    .drawImage(
                      playImage,
                      startX,
                      startY,
                      playImage.width,
                      playImage.height
                    );
                  canvas.toBlob() = (blob) => {
                    const img = new Image();
                    img.src = window.URL.createObjectUrl(blob);
                  };
                };


              }, 1000);
            };
            */
    </script>
  </body>
</html>
